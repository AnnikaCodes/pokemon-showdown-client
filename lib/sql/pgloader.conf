
LOAD DATABASE
FROM mysql://ps@ip6-localhost/ps
INTO pgsql:///ps

    ALTER TABLE NAMES MATCHING 'ps_prepreplays' RENAME TO 'prepreplays'
    ALTER TABLE NAMES MATCHING 'ps_replays' RENAME TO 'replays'

    ALTER TABLE NAMES MATCHING 'ntbb_friendlist' RENAME TO 'friendlist'
    ALTER TABLE NAMES MATCHING 'ntbb_ladder' RENAME TO 'ladder'
    ALTER TABLE NAMES MATCHING 'ntbb_loginthrottle' RENAME TO 'loginthrottle'
    ALTER TABLE NAMES MATCHING 'ntbb_sessions' RENAME TO 'sessions'
    ALTER TABLE NAMES MATCHING 'ntbb_usermodlog' RENAME TO 'usermodlog'
    ALTER TABLE NAMES MATCHING 'ntbb_users' RENAME TO 'users'
    ALTER TABLE NAMES MATCHING 'ntbb_userstats' RENAME TO 'userstats'
    ALTER TABLE NAMES MATCHING 'ntbb_userstatshistory' RENAME TO 'userstatshistory'

    CAST column ntbb_users.loginip to inet drop typemod using varbinary-to-string,
        column ntbb_users.ip to inet drop typemod using empty-string-to-null,
        column ntbb_usermodlog.ip to inet drop typemod using empty-string-to-null,
        column ntbb_sessions.ip to inet drop typemod using empty-string-to-null,

        column ps_replays.private to smallint drop typemod,
        column ps_prepreplays.private to smallint drop typemod,

       	column ps_prepreplays.uploadtime to timestamptz using unix-timestamp-to-timestamptz,
	column ps_replays.uploadtime to timestamptz using unix-timestamp-to-timestamptz,
	column ntbb_ladder.rptime to timestamptz using unix-timestamp-to-timestamptz,
        column ntbb_loginthrottle.time to timestamptz using unix-timestamp-to-timestamptz,
        column ntbb_sessions.time to timestamptz using unix-timestamp-to-timestamptz,
        column ntbb_sessions.timeout to timestamptz using unix-timestamp-to-timestamptz,
        column ntbb_users.registertime to timestamptz using unix-timestamp-to-timestamptz,
        column ntbb_users.logintime to timestamptz using unix-timestamp-to-timestamptz,
        column ntbb_usermodlog.date to timestamptz using unix-timestamp-to-timestamptz,
        column ntbb_userstats.date to timestamptz using unix-timestamp-to-timestamptz,
        column ntbb_userstatshistory.date to timestamptz using unix-timestamp-to-timestamptz,

        type varbinary to text drop typemod using varbinary-to-string,
        type mediumblob to text drop typemod using varbinary-to-string
-- test it out?

    ALTER SCHEMA 'ps' RENAME TO 'public';
